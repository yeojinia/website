<!DOCTYPE html> 
<html>

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Insert title here</title>
<script type = "text/javascript" src="project.js"></script>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="css/rSlider.min.css">

<style>
.top {
	background-color: #333;
	border-bottom: 3px solid #00b3bc;
	color: #fff;
	padding: 20px;
	}
.top h1 {
	font-size: 20px;
	text-align: center;
}
.container {
	width: 80%;
	margin: 170px auto;
}
.slider-container {
	width: 90%;
	max-width: 500px;
	margin: 0 auto 50px;
}

	.state{
		fill: none;
		stroke: #a9a9a9;
		stroke-width: 1;
	}
	.state:hover{
		fill-opacity:0.5;
	}
	#tooltip {   
		position: absolute;           
		text-align: center;
		padding: 20px;             
		margin: 10px;
		font: 12px sans-serif;        
		background: lightsteelblue;   
		border: 1px;      
		border-radius: 2px;           
		pointer-events: none;         
	}
	#tooltip h4{
		margin:0;
		font-size:14px;
	}
	#tooltip{
		background:rgba(0,0,0,0.9);
		border:1px solid grey;
		border-radius:5px;
		font-size:12px;
		width:auto;
		padding:4px;
		color:white;
		opacity:0;
	}
	#tooltip table{
		table-layout:fixed;
	}
	#tooltip tr td{
		padding:0;
		margin:0;
	}
	#tooltip tr td:nth-child(1){
		width:50px;
	}
	#tooltip tr td:nth-child(2){
		text-align:center;
	}
</style>

</head>

<body>
<div class="top"> <h1> COVID-19 Data Visualization </h1> </div>

<div class="container">
	<div class="slider-container">
		<input type="text" id="slider" class="slider" />
	</div>
</div>

	<script src="js/rSlider.min.js"></script>
    <script>
        (function () {
            'use strict';

            var init = function () {                
                var slider = new rSlider({
                    target: '#slider',
                    values: ['March', 'April', 'May', 'June', 'July', 'August','September'],
                    range: true,
                    set: ['March', 'September'],
                    onChange: function (vals) {
                        console.log(vals);
                    }
                });
            };
            window.onload = init;
        })();
    </script>


<div id="tooltip"></div><!-- div to hold tooltip. -->
<svg width="960" height="600" id="statesvg"></svg> <!-- svg to hold the map. -->
<svg width ="400" height="500" id="barchart"></svg>
<script src="uStates.js"></script> <!-- creates uStates. -->
<script src = "http://d3js.org/d3.v3.js"></script>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>

<script src="https://d3js.org/d3-dsv.v2.min.js"></script>
<script src="https://d3js.org/d3-fetch.v2.min.js"></script>

<div class="rangeslider"> 
<input type="range" min="1" max="100" value="10" class="myslider" id="sliderRange">
<p>Value: <span id="demo"></span></p> 
</div>

<script>
function tooltipHtml(n, d){	/* function to create html content string in tooltip div. */
		return "<h4>"+n+"</h4><table>"+
			//"<tr><td>Low</td><td>"+(d.low)+"</td></tr>"+
			//"<tr><td>Average</td><td>"+(d.avg)+"</td></tr>"+
			//"<tr><td>High</td><td>"+(d.high)+"</td></tr>"+
			"</table>";
	}
	
	var sampleData ={};	/* Sample random data. */	
	["HI", "AK", "FL", "SC", "GA", "AL", "NC", "TN", "RI", "CT", "MA",
	"ME", "NH", "VT", "NY", "NJ", "PA", "DE", "MD", "WV", "KY", "OH", 
	"MI", "WY", "MT", "ID", "WA", "DC", "TX", "CA", "AZ", "NV", "UT", 
	"CO", "NM", "OR", "ND", "SD", "NE", "IA", "MS", "IN", "IL", "MN", 
	"WI", "MO", "AR", "OK", "KS", "LS", "VA"]
		.forEach(function(d){ 
			var low=Math.round(100*Math.random()), 
				mid=Math.round(100*Math.random()), 
				high=Math.round(100*Math.random());
			sampleData[d]={low:d3.min([low,mid,high]), high:d3.max([low,mid,high]), 
					avg:Math.round((low+mid+high)/3), color:d3.interpolate("#ffffcc", "#800026")(low/100)}; 
		});
	
	/* draw states on id #statesvg */	
	uStates.draw("#statesvg", sampleData, tooltipHtml);
	
	d3.select(self.frameElement).style("height", "600px"); 
</script>

<script>
	const dataFile =[50.5,51.34782609,51.875,53.20833333,54.58333333,55.16666667,58.125,56.20833333,53.66666667,52.54166667,50.95833333,51.45833333,53.375,55.5,57.08333333,57.04166667,54.75,56.04166667,60.41666667,66.25,55.42424242,56.03448276,57.79166667,59.91666667,59.16666667,59.625,62.25,58.79166667,56.29166667,58.45833333,59.08333333,61.20833333,64.16666667,56.72,43.54166667,44.95833333,48.33333333,53.91666667,57.45833333,60.88,60.08333333,52.8,53.375,55.41666667,59,59,60.58333333,62.04166667,64.20833333,64.6,66.33333333,68.95833333,60.29411765,57.20833333,59.45833333,58.56,56.95833333,61.41666667,64.75,65.83333333,64.45833333,60,62.83333333,61.95833333,68.70833333,72.83333333,71.83333333,67.375,66.83333333,66.38461538,63.42857143,64.83333333,57.10526316,64.80952381,64.66666667,66.8,65.45833333,57.85185185,56.5,60.54166667,64.08333333,64.75,67.20833333,66.92,66.66666667,63.41666667,58.04166667,59.375,65.25,66.12,68.29166667,72.95833333,71.33333333,71.29166667,71.79166667,72.29166667,71.45833333,72.11538462,69,63.20833333,65.83333333,63.5,64.70833333,67.68,69.625,70.16666667,72.25,73.25,68.70833333,71.79166667,75.75,73.88,77.08333333,82.16666667,84.58333333,86.08333333,87.45833333,87.375,86.66666667,89.375,89.58333333,87.41666667,86.33333333,85.2,85.25,88.41666667,90.75,90.75,91.08333333,90.29166667,88.06896552,88,84.45833333,80.25,80.70833333,83.08333333,86.41666667,89.16,88.07407407,81.52,76.12,79.70833333,82.08333333,82.875,83.70833333,85.45833333,89.16666667,92.75,96.33333333,97.95833333,98.22222222,95.79166667,94.54166667,97.25,98.375,98.95833333,95.5,83.91666667,86.61538462,82.80769231,83.6,89.25,94.12,95.84,93.76,91.28,92.68,93.4,91.08,90.58333333,90.625,92.625,94.91666667,96.125,96.83333333,97.45833333,97.58333333,96.58333333,96.56,93.2,90.41666667,88.70833333,91.375,93.29166667,94.83333333,99.16,100,99.08333333,99.08333333,100.75,100.125,101.5,103.7916667,105.3076923,103.8333333,101,99.79166667,100.68,99.75,100.9583333,101.0833333,97.41666667,99.33333333,97.95833333,92.45833333,89,93,98.33333333,100.76,101.8333333,102.8333333,104.25,104.875,101.8333333,100,101.5833333,99.29166667,100.5416667,96.91666667,97.45833333,100.24,99.08333333,99.70833333,98.88,100,102.625,103.9166667,103.25,102.4375,101.6129032,103.0384615,103.52,95.70588235,91.83333333];
	
	var temperature_freq = new Array(7);
	
	for(var i =0; i<temperature_freq.length; i++){
		temperature_freq[i] = 0 ;
	}
	
	const belowFifty = [];
	const fiftyToSixty = [];
	const sixtyToSeventy = [];
	const seventyToEighty = [];
	const eightyToNinety = [];
	const ninetyToOneHundred = [];
	const overOnehundred = [];
	
	for(var i =0; i<dataFile.length; i++){
		if(dataFile[i] <50){
			belowFifty.push(dataFile[i]);
			temperature_freq[0]++;
		}
		else if(dataFile[i] >=50 && dataFile[i] < 60){
			fiftyToSixty.push(dataFile[i]);
			temperature_freq[1]++;
		}
		else if(dataFile[i] >=60 && dataFile[i] < 70){
			sixtyToSeventy.push(dataFile[i]);
			temperature_freq[2]++;
		}
		else if(dataFile[i] >=70 && dataFile[i] < 80){
			seventyToEighty.push(dataFile[i]);
			temperature_freq[3]++;
		}
		else if(dataFile[i] >=80 && dataFile[i] < 90){
			eightyToNinety.push(dataFile[i]);
			temperature_freq[4]++;
		}
		else if(dataFile[i] >=90 && dataFile[i] < 100){
			ninetyToOneHundred.push(dataFile[i]);
			temperature_freq[5]++;
		}
		else{
			overOnehundred.push(dataFile[i]);
			temperature_freq[6]++;
		}
	}
	
	const temp_ranges = ["50", "60", "60", "60", "60", "60", "60"];
	const color = ['skyblue','yellowgreen','violet','blueviolet','chocolate','darkgreen','yellow']
	/*
	for(var i =0; i<temperature_freq.length; i++){
		console.log(temperature_freq[i]);
	}
	console.log(belowFifty.length);
	*/
	
	const svg = d3.select('#barchart');	

	var w= 400;
	var h= 200;
	var padding = 10;	
	
	var y = d3.scale.linear()
		.domain([0, d3.max(temperature_freq)])
		.range([h-padding,0])
	var x = d3.scale.linear()
		.domain([0, temperature_freq.length])
        .range([0, w])

	var xAxis = d3.svg.axis()
				.scale(x)
				.orient('bottom');
	var yAxis = d3.svg.axis()
				.scale(y)
				.ticks(5)
				.orient('left');
	svg.append('g')
	   .attr('class', 'axis')
		.attr('transform', "translate("+padding+",0)")
		.call(yAxis);
				
	svg.append("g").call(xAxis)
		.attr('class', 'axis')
		.attr('transform',"translate(0,"+(h-padding)+")")
		.call(xAxis)
		
	// text label for the x axis
	//svg.append("text")             
	//    .attr("transform", "translate(" + (width/2) + " ," + (height + margin.top + 20) + ")")
	//    .style("text-anchor", "middle")
	//    .text(temp_ranges);	

	svg.append("path")
		.data(temp_ranges)
		.attr("class", "line")

			
	svg.selectAll('bar')
		.data(temperature_freq)
		.enter().append('rect')
		.attr('fill',function(d,i) {return color[i];})
		.attr('x', function(d, i) {return x(i); } )
		.attr('y', function(d) {return y(d)+padding; })
		.attr('width', function(d, i) {return x(1)-1;})
		.attr('height', function(d) {return h-(y(d) + padding);})


	//.attr('y', (d, i) => {return 100-temperature_freq[i]})
		
	//var svgdiv = $("#my_dataviz");
	//var divwidth = svgdiv.width();


	var rangeslider = document.getElementById("sliderRange");
	var output = document.getElementById("demo");
	output.innerHTML = rangeslider.value;
	
	rangeslider.oninput = function() {
	  output.innerHTML = this.value;
	}

</script>


<script>

d3.csv("C:/Users/kyj87/eclipse-workspace/javascript_test/data/total_daily_stats2.csv", function(error, data) {
	if(error) throw error;
	  console.log(data);
});



//d3.csv("./data/total_daily_stats2.csv")
//    .row(function(d) { return {key: d.key, value: +d.value}; })
//    .get(function(error, rows) { console.log(rows); });

</script>

</body>
</html>
